<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>New Tab</title>
    <style>
    body {
        background-color: black;
        color: #00ff00;
        font-family: "Courier New", Courier, monospace;
        margin: 0;
        padding: 0;
    }
    h1, h2 {
        text-align: center;
        color: #00ff00;
        margin: 20px 0;
    }
    #primeResult, #goldbachResult, #collatzResult {
        font-size: 80px;
        text-align: center;
        color: #00ff00;
        margin: 10px 0;
    }
    hr {
        border: 1px solid #00ff00;
        margin: 40px 0;
    }
    .button-container {
        text-align: center;
        margin: 20px 0;
    }
    button, input[type="number"] {
        background-color: black;
        border: 2px solid #00ff00;
        color: #00ff00;
        margin: 0 10px;
        padding: 10px 20px;
        font-size: 18px;
        cursor: pointer;
        transition: all 0.2s ease;
        border-radius: 5px;
    }
    button:hover, input[type="number"]:focus {
        background-color: #003300;
        border-color: #00ff00;
        color: #00ff00;
        outline: none;
    }


    input::placeholder {
        color: #00ff00;
        opacity: 0.7;
    }
</style>

</head>
<body>
    <div class="button-container">
        <button id="toggleButton">STOP</button>
        <button id="copyPrimeButton">COPY PRIME</button>
        <button id="formatPrimeButton">FORMAT/UNFORMAT</button>
        <input style="color: #00ff00;" type="number" id="speedInput" placeholder="Speed (ms)">
        <button id="setSpeedButton">SET SPEED</button>
        <button id="changeSpeedButton">SPEED: 100ms</button>
    </div>

    <!-- PRIME NUMBER FINDER -->
    <h1>Prime Number Finder</h1>
    <h1 id="primeResult"></h1>

    <hr>

    <!-- GOLDBACH CONJECTURE SOLVER -->
    <h1>Goldbach Conjecture Solver</h1>
    <h2 style="font-size: 80px;" id="goldbachResult"></h2>

    <hr>

    <!-- COLLATZ SOLVER -->
    <h1>Collatz Solver Program</h1>
    <h2 style="font-size: 80px;" id="collatzResult"></h2>

    <script>
        // -------------- PRIME CHECK ----------
        function isPrime(num) {
            if (num <= 1) return false;
            if (num === 2) return true;
            if (num % 2 === 0) return false;
            for (let i = 3; i <= Math.sqrt(num); i += 2) {
                if (num % i === 0) return false;
            }
            return true;
        }

        // ------------ PRIME NUMBER FINDER --------------
        let currentPrime = 999998727945487n;
        function findPrimeNumbers() {
            while (!isPrime(Number(currentPrime))) {
                currentPrime++;
            }
            document.getElementById("primeResult").textContent = currentPrime.toString();
            currentPrime++;
        }

        // ----------- GOLDBACH CONJECTURE -------------
        let currentEven = 4;
        function goldbachConjecture(n) {
            for (let i = 2; i <= n / 2; i++) {
                if (isPrime(i) && isPrime(n - i)) {
                    return `${n - i} + ${i} = ${n}`;
                }
            }
            return "No solution found";
        }
        function updateGoldbach() {
            document.getElementById("goldbachResult").textContent =
                goldbachConjecture(currentEven);
            currentEven += 2;
        }

        // ------------ COLLATZ SOLVER -----------
        function collatzSolver(num) {
            let order = 1;
            while (num !== 1 && order <= 500) {
                if (num % 2 === 0) {
                    num = num / 2;
                } else {
                    num = num * 3 + 1;
                }
                order++;
            }
            return order;
        }
        let currentCollatz = 1;
        function updateCollatz() {
            let steps = collatzSolver(currentCollatz);
            document.getElementById("collatzResult").textContent =
                `Takes ${steps} steps to reach 1 from ${currentCollatz}.`;
            currentCollatz++;
        }

        // ------------- INTERVAL HANDLERS ----------
        let primeInterval, goldbachInterval, collatzInterval;
        let running = true;
        let speedOptions = [100, 500, 1000]; 
        let currentSpeed = 100;

        function startIntervals() {
            primeInterval = setInterval(findPrimeNumbers, currentSpeed);
            goldbachInterval = setInterval(updateGoldbach, currentSpeed);
            collatzInterval = setInterval(updateCollatz, currentSpeed);
            running = true;
        }

        function stopIntervals() {
            clearInterval(primeInterval);
            clearInterval(goldbachInterval);
            clearInterval(collatzInterval);
            running = false;
        }


        startIntervals();

        // ---------- TOGGLE BUTTON -------------
        const toggleButton = document.getElementById("toggleButton");
        toggleButton.addEventListener("click", () => {
            const primeEl = document.getElementById("primeResult");
            const text = primeEl.textContent.trim();

            if (!running) {
                if (formatted) {
                    alert("Please unformat the prime number before resuming.");
                    return;
                }
                startIntervals();
                toggleButton.textContent = "STOP";
            } else {
                stopIntervals();
                toggleButton.textContent = "RESUME";
            }
        });

        // ---------- COPY PRIME BUTTON -------------
        const copyPrimeButton = document.getElementById("copyPrimeButton");
        copyPrimeButton.addEventListener("click", () => {
            const primeText = document.getElementById("primeResult").textContent;
            if (primeText) {
                navigator.clipboard.writeText(primeText)
                    .then(() => {
                        copyPrimeButton.textContent = "COPIED!";
                        setTimeout(() => {
                            copyPrimeButton.textContent = "COPY PRIME";
                        }, 1000);
                    })
                    .catch(err => console.error("Failed to copy prime:", err));
            }
        });

        // ---------- FORMAT/UNFORMAT PRIME BUTTON -----------
        const formatPrimeButton = document.getElementById("formatPrimeButton");
        let formatted = false;

        function bigIntLog(num, base = 2.5) {
            const numStr = num.toString();
            const digits = numStr.length;
            const leading = parseInt(numStr.slice(0, 15));
            const log10 = digits - 1 + Math.log10(leading / 1e14);
            return log10 / Math.log10(base);
        }

        formatPrimeButton.addEventListener("click", () => {
            if (running) {
                alert("Please stop the prime finder before formatting or unformatting.");
                return;
            }

            const primeEl = document.getElementById("primeResult");
            let text = primeEl.textContent.trim();

            if (!formatted) {
                let num;
                try {
                    num = BigInt(text);
                } catch {
                    alert("Cannot format this number.");
                    return;
                }

                let exponent = Math.max(2, Math.round(bigIntLog(num, 2.5)));
                let base = Math.pow(10, Math.log10(Number(num)) / exponent);
                base = Math.round(base * 100) / 100;

                primeEl.textContent = `${base}^${exponent}`;
                formatted = true;
            } else {
                const match = text.match(/([\d.]+)\^(\d+)/);
                if (match) {
                    const base = parseFloat(match[1]);
                    const exponent = parseInt(match[2]);
                    const value = Math.round(base ** exponent);
                    primeEl.textContent = value.toString();
                    formatted = false;
                } else {
                    alert("Cannot unformat this string.");
                }
            }
        });

        // ---------- CHANGE SPEED BUTTON -------------
        const changeSpeedButton = document.getElementById("changeSpeedButton");
        changeSpeedButton.addEventListener("click", () => {
            if (!running) return;
            changeSpeedButton.textContent = `SPEED: ${currentSpeed}ms`;
        });

        // ---------- SPEED INPUT BUTTON -----------
        const speedInput = document.getElementById("speedInput");
        const setSpeedButton = document.getElementById("setSpeedButton");

        setSpeedButton.addEventListener("click", () => {
            const value = parseInt(speedInput.value);
            if (isNaN(value) || value < 1) {
                alert("Please enter a valid speed in milliseconds (>=1).");
                return;
            }

            currentSpeed = value;

            if (running) {
                clearInterval(primeInterval);
                clearInterval(goldbachInterval);
                clearInterval(collatzInterval);

                primeInterval = setInterval(findPrimeNumbers, currentSpeed);
                goldbachInterval = setInterval(updateGoldbach, currentSpeed);
                collatzInterval = setInterval(updateCollatz, currentSpeed);
            }

            changeSpeedButton.textContent = `SPEED: ${currentSpeed}ms`;
        });
    </script>
</body>
</html>

